# 魔塔API 手写图片转文字脚本
基于魔塔（ModelScope）OpenAI兼容接口实现的批量手写图片转文字工具，支持多图片批量识别、严格按手写排版转录，适配Qwen3-VL-8B-Instruct等多模态大模型。

## 功能特点
✅ 批量识别：自定义每批识别图片数量（默认3张/批），高效处理大量手写图片  
✅ 精准转录：严格按手写排版顺序逐行识别，保留原始格式与小字批注  
✅ 格式规范：输出结果自动按图片命名分隔，便于整理核对  
✅ 兼容性强：支持jpg/jpeg/png/bmp/webp等主流图片格式  
✅ 错误处理：识别失败时保留错误信息，不中断整体流程  

## 前置准备
### 1. 获取魔塔API Key
- 前往 [魔塔官网](https://www.modelscope.cn/) 注册并登录账号  
- 在控制台获取API Key（需确保账号有对应模型的调用权限）  

### 2. 环境依赖
```bash
pip install requests
```

## 使用教程
### 1. 配置修改
打开 `转换脚本.py`，修改以下3处核心配置：
```python
# ====================== 【使用时仅需修改这3处】 ======================
API_KEY = "YOUR API KEYS"          # 替换成你的魔塔API Key
IMAGE_FOLDER = r"图片/"   # 你的照片文件夹路径（绝对/相对路径均可）
OUTPUT_FILE = "转文字结果.txt"   # 识别结果输出的文本文件名
# BATCH_SIZE = 3                  # 可选：调整每批识别的图片数量
# ==============================================================
```

### 2. 准备图片
将需要识别的手写图片放入配置的 `IMAGE_FOLDER` 文件夹中，支持的格式：  
`.jpg .jpeg .png .bmp .webp`  

### 3. 运行脚本
```bash
python 转换脚本.py
```

### 4. 查看结果
识别完成后，结果会自动保存到 `OUTPUT_FILE` 指定的文本文件中，格式示例：
```
========== 第 1 批识别结果 ==========
===== 图片1: 日记01.jpg =====
2024年5月20日 星期一 晴
今天和同学去图书馆看书，完成了数学作业，
晚上回家做了番茄炒蛋，味道还不错。
===== 图片2: 日记02.jpg =====
2024年5月21日 星期二 阴
早上起晚了，差点迟到，
课间和同桌讨论了周末的出游计划。
```

## 额外工具：查看可用模型
提供 `大模型列表.py` 脚本，可查看你的API Key可调用的所有模型：
1. 修改脚本中的 `API_KEY`  
2. 运行脚本：
   ```bash
   python 大模型列表.py
   ```
3. 输出示例：
   ```
   === 魔塔API 可用模型列表 ===
   - Qwen/Qwen3-VL-8B-Instruct
   - Qwen/Qwen2-VL-7B-Instruct
   ```

## 注意事项
1. 模型选择：默认使用 `Qwen/Qwen3-VL-8B-Instruct`，可根据API权限替换为其他多模态模型  
2. 识别效果：手写字迹越清晰，识别准确率越高；模糊字迹会尽量按字形推测  
3. 超时设置：默认超时时间300秒（5分钟），若批量识别大尺寸图片可适当延长  
4. 接口限制：请遵守魔塔API的调用频率/额度限制，避免超限导致失败  
5. 编码问题：脚本默认使用UTF-8编码，确保输出文件无乱码  

## 常见问题
### Q1: 提示"未在指定文件夹找到图片文件"
- 检查 `IMAGE_FOLDER` 路径是否正确（绝对路径推荐）  
- 确认文件夹内图片格式是否为支持的类型  
- 检查文件名是否包含特殊字符（建议使用数字/字母命名）  

### Q2: 识别失败/返回错误信息
- 验证API Key是否有效，且有对应模型的调用权限  
- 检查网络连接，确保能访问魔塔接口 `https://api-inference.modelscope.cn`  
- 减少单批识别的图片数量（降低 `BATCH_SIZE`）  
- 确认图片文件未损坏，可尝试单独识别单张图片测试  

### Q3: 识别结果遗漏内容
- 调整 `max_tokens` 参数（默认16384），增大上下文容量  
- 降低每批识别的图片数量，避免单批内容过多  
- 检查图片是否清晰，可重新拍摄/扫描图片  

## 许可证
本项目采用 MIT 许可证开源，你可以自由使用、修改和分发，商用/非商用均可。

## 免责声明
1. 本脚本仅为工具类脚本，识别结果仅供参考，需自行核对准确性  
2. 使用本脚本需遵守魔塔API的服务条款，请勿用于违规场景
3. 作者不对因使用本脚本导致的任何损失（包括但不限于数据丢失、接口费用等）负责

## 最后
如果这个项目帮到了你，欢迎请我喝杯咖啡，让我有动力继续维护和更新 ☕️
TRC20 Address:`TEinJC5NaJKGm26ALd2st6nEiAnbThPj4U`




